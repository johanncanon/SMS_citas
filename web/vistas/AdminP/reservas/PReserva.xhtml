<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">


    <ui:composition template="./../template-admin-p.xhtml">

        <ui:define name="content">
            <b:container fluid="true">
                <b:row>
                    <b:column col-lg="12" col-md="12" col-xs="12" col-sm="12" >

                        <div class="box box-danger direct-chat direct-chat-danger mrg-cl-1" style="padding-bottom: 20px; padding-left: 20px; padding-right: 20px">
                            <div class="box-header with-border" style="margin-bottom: 12px">
                                <i class="fa fa-car"></i>
                                <h3 class="box-title">Reservación de Vehiculo SMS Renta</h3>
                            </div>
                            <h:form>
                                <p:wizard flowListener="#{reservacionBean.onFlowProcess}"  nextLabel="Siguiente" backLabel="Regresar">
                                    <p:tab id="Agendamiento" title="Agendamiento">
                                        <p:messages autoUpdate="true"/>
                                        <b:panel title="Seleccione el cliente al cual realizara la reservacion"  look="primary" style="text-decoration: none">

                                            <p style="margin-top: 12px">Seleccione el cliente al que desea generarle una reservación:</p>
                                            <hr/>
                                            <h:panelGrid columns="2" width="100%" cellpadding="5">

                                                <p:outputLabel for="SClientes" value="Cliente:" class="fa fa-2x fa-globe"/>
                                                <p:selectOneMenu id="SClientes" requiredMessage="Seleccione cliente con el cual quiere realizar la reservación"  required="true" style="width: 100%" value="#{reservacionBean.clienteView.usuarioNombre}">
                                                    <f:selectItem itemLabel="Seleccione cliente" noSelectionOption="true"/>
                                                    <f:selectItems value="#{clienteBean.nombresClientesListView}"/>
                                                </p:selectOneMenu>

                                            </h:panelGrid>
                                        </b:panel> 

                                        <b:panel title="Ingrese Ciudad de Destino"  look="primary" style="text-decoration: none">

                                            <p style="margin-top: 12px">La ciudad de destino es el lugar en el
                                                cual será recogido por nuestro Conductor:</p>
                                            <hr/>
                                            <h:panelGrid columns="2" width="100%" cellpadding="5">

                                                <p:outputLabel value="Ciudad:" class="fa fa-2x fa-globe"/>
                                                <p:selectOneMenu requiredMessage="Indique ciudad donde quiere solicitar el servicio" required="true" style="width: 100%" value="#{reservacionBean.ciudadView.ciudadNombre}">
                                                    <f:selectItem itemLabel="Seleccione Ciudad" noSelectionOption="true"/>
                                                    <f:selectItems value="#{ciudadBean.nombresCiudadesListView}"/>                                                    
                                                    <p:ajax event="change" listener="#{reservacionBean.consultarLugaresCiudades()}" update="SLRecogida SLEntrega" />
                                                </p:selectOneMenu>                                                

                                                <p:outputLabel value="Lugar de recogida:" class="fa fa-2x fa-building"/>
                                                <p:selectOneMenu   requiredMessage="Indique lugar de recogida" id="SLRecogida" required="true" style="width: 100%" value="#{reservacionBean.reservaView.reservacionLugarLlegada}">
                                                    <f:selectItem itemLabel="Seleccione Lugar de recogida" noSelectionOption="true"/>
                                                    <f:selectItems value="#{reservacionBean.nombresLugaresListView}"/>
                                                </p:selectOneMenu>                                                

                                                <p:outputLabel value="Lugar de entrega:" class="fa fa-2x fa-building-o"/>
                                                <p:selectOneMenu  requiredMessage="Indique lugar de Entrega" id="SLEntrega" required="true" style="width: 100%" value="#{reservacionBean.reservaView.reservacionLugarDestino}">
                                                    <f:selectItem itemLabel="Seleccione Lugar de entrega" noSelectionOption="true"/>
                                                    <f:selectItems value="#{reservacionBean.nombresLugaresListView}"/>
                                                </p:selectOneMenu>  
                                            </h:panelGrid>
                                        </b:panel>  


                                        <b:panel title="Fechas  de la reservación" look="primary" >                                           

                                            <p style="margin-top: 12px">Aqui podrá definir la fecha de inicio del servicio y la fecha de 
                                                final del servicio SMS:</p>
                                            <hr/>                                         

                                            <h:panelGrid columns="2" cellpadding="5" width="60%">                                                  
                                                <p:outputLabel for="SServicio" value="Tipo de servicio"/>
                                                <p:selectOneMenu id="SServicio" style="width: 100%" binding="#{Servicio}" requiredMessage="Seleccione servicio" required="true" value="#{reservacionBean.servicioView.serviciosNombre}">
                                                    <f:selectItem itemLabel="Seleccione tipo de servicio" noSelectionOption="true" />
                                                    <f:selectItems value="#{serviciosBean.nombreServiciosListView}"/>
                                                </p:selectOneMenu>

                                                <p:outputLabel for="CFechaInicio"  value="Fecha de Inicio:"/>                                                    
                                                <p:calendar id="CFechaInicio" style="width: 100%" styleClass="dateTimeField" placeholder="Seleccione fecha de inicio"  binding="#{FInicio}" pattern="yyyy-MM-dd" value="#{reservacionBean.reservaView.reservacionFechaInicio}" required="true"/>

                                                <p:outputLabel for="CFechaEntrega" value="Fecha de Entrega:" />
                                                <p:calendar id="CFechaEntrega" style="width: 100%" styleClass="dateTimeField" placeholder="Seleccione fecha de entrega" binding="#{FEntrega}" pattern="yyyy-MM-dd" value="#{reservacionBean.reservaView.reservacionFechaLlegada}" required="true"/>

                                            </h:panelGrid>

                                            <h:panelGrid columns="3" cellpadding="5" width="60%">
                                                <p:outputLabel value="Hora de inicio:" style="width: 100%" />
                                                <b:selectOneMenu id="SHoraInicio" binding="#{HInicio}" value="#{reservacionBean.horaInicio}" style="width: 100%">
                                                    <f:selectItem itemLabel="00" itemValue="01"/>
                                                    <f:selectItem itemLabel="01" itemValue="01"/>
                                                    <f:selectItem itemLabel="02" itemValue="02"/>
                                                    <f:selectItem itemLabel="03" itemValue="03"/>
                                                    <f:selectItem itemLabel="04" itemValue="04"/>
                                                    <f:selectItem itemLabel="05" itemValue="05"/>
                                                    <f:selectItem itemLabel="06" itemValue="06"/>
                                                    <f:selectItem itemLabel="07" itemValue="07"/>
                                                    <f:selectItem itemLabel="08" itemValue="08"/>
                                                    <f:selectItem itemLabel="10" itemValue="10"/>
                                                    <f:selectItem itemLabel="11" itemValue="11"/>
                                                    <f:selectItem itemLabel="12" itemValue="12"/>
                                                    <f:selectItem itemLabel="13" itemValue="13"/> 
                                                    <f:selectItem itemLabel="14" itemValue="14"/>                                                     
                                                    <f:selectItem itemLabel="15" itemValue="15"/> 
                                                    <f:selectItem itemLabel="16" itemValue="16"/> 
                                                    <f:selectItem itemLabel="17" itemValue="17"/> 
                                                    <f:selectItem itemLabel="18" itemValue="18"/> 
                                                    <f:selectItem itemLabel="19" itemValue="19"/> 
                                                    <f:selectItem itemLabel="20" itemValue="20"/> 
                                                    <f:selectItem itemLabel="21" itemValue="21"/> 
                                                    <f:selectItem itemLabel="22" itemValue="22"/>
                                                    <f:selectItem itemLabel="23" itemValue="23"/>
                                                </b:selectOneMenu> 
                                                <b:selectOneMenu id="SMinutosInicio" binding="#{MInicio}" value="#{reservacionBean.minutosInicio}" style="width: 100%">
                                                    <f:selectItem itemLabel="00:00" itemValue="00:00"/>
                                                    <f:selectItem itemLabel="15:00" itemValue="15:00"/>
                                                    <f:selectItem itemLabel="30:00" itemValue="30:00"/>                                                   
                                                    <f:selectItem itemLabel="45:00" itemValue="45:00"/>                                                
                                                </b:selectOneMenu>
                                                <p:outputLabel value="Hora de entrega:" />
                                                <b:selectOneMenu id="SHoraEntrega" binding="#{HEntrega}" value="#{reservacionBean.horaEntrega}" style="width: 100%">
                                                    <f:selectItem itemLabel="00" itemValue="01"/>
                                                    <f:selectItem itemLabel="01" itemValue="01"/>
                                                    <f:selectItem itemLabel="02" itemValue="02"/>
                                                    <f:selectItem itemLabel="03" itemValue="03"/>
                                                    <f:selectItem itemLabel="04" itemValue="04"/>
                                                    <f:selectItem itemLabel="05" itemValue="05"/>
                                                    <f:selectItem itemLabel="06" itemValue="06"/>
                                                    <f:selectItem itemLabel="07" itemValue="07"/>
                                                    <f:selectItem itemLabel="08" itemValue="08"/>
                                                    <f:selectItem itemLabel="10" itemValue="10"/>
                                                    <f:selectItem itemLabel="11" itemValue="11"/>
                                                    <f:selectItem itemLabel="12" itemValue="12"/>
                                                    <f:selectItem itemLabel="13" itemValue="13"/> 
                                                    <f:selectItem itemLabel="14" itemValue="14"/>                                                    
                                                    <f:selectItem itemLabel="15" itemValue="15"/> 
                                                    <f:selectItem itemLabel="16" itemValue="16"/> 
                                                    <f:selectItem itemLabel="17" itemValue="17"/> 
                                                    <f:selectItem itemLabel="18" itemValue="18"/> 
                                                    <f:selectItem itemLabel="19" itemValue="19"/> 
                                                    <f:selectItem itemLabel="20" itemValue="20"/> 
                                                    <f:selectItem itemLabel="21" itemValue="21"/> 
                                                    <f:selectItem itemLabel="22" itemValue="22"/>
                                                    <f:selectItem itemLabel="23" itemValue="23"/>
                                                </b:selectOneMenu> 
                                                <b:selectOneMenu value="#{reservacionBean.minutosEntrega}" id="SMinutosLlegada"  style="width: 100%">
                                                    <f:selectItem itemLabel="00:00" itemValue="00:00"/>
                                                    <f:selectItem itemLabel="15:00" itemValue="15:00"/>
                                                    <f:selectItem itemLabel="30:00" itemValue="30:00"/>                                                   
                                                    <f:selectItem itemLabel="45:00" itemValue="45:00"/> 
                                                    <f:attribute name="fechaInicio" value="#{FInicio.value}"/>
                                                    <f:attribute name="horaInicio" value="#{HInicio.value}"/>
                                                    <f:attribute name="minutosInicio" value="#{MInicio.value}"/>
                                                    <f:attribute name="fechaEntrega" value="#{FEntrega.value}"/>
                                                    <f:attribute name="horaEntrega" value="#{HEntrega.value}"/>
                                                    <f:attribute name="servicio" value="#{Servicio.value}"/>
                                                    <f:validator validatorId="dateTimeValidator"/>
                                                </b:selectOneMenu>
                                            </h:panelGrid> 
                                        </b:panel>
                                        <p:messages autoUpdate="true"/> 
                                    </p:tab>

                                    <p:tab id="Vehiculo" title="Vehiculo" >
                                        <b:panel title="Defina la categoría y seleccione vehiculo" look="primary">
                                            <p:messages autoUpdate="true" />
                                            <p style="margin-top: 12px">Aqui podrá elegir el vehiculo que desea para su reservacion:</p>
                                            <hr/>
                                            <div class="form-group">
                                                <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5">
                                                    <p:outputLabel value="Categoria de Vehículo: "  />
                                                    <p:selectOneMenu value="#{reservacionBean.categoriaView.categoriaNombre}" style="width:250px">
                                                        <f:selectItem itemLabel="Seleccione categoria del vehículo" noSelectionOption="true"/>
                                                        <f:selectItems value="#{categoriaBean.nombresCategoriasListView}"/>
                                                        <p:ajax event="change" listener="#{reservacionBean.filtrar()}" process="@this" update="ScrollerVehiculos"/>
                                                    </p:selectOneMenu>                                                       

                                                    <p:outputLabel value="Vehículo Seleccionado "  />
                                                    <b:inputText id="TVehSelc" placeholder="Placa del vehículo" required="true" style="width:250px" requiredMessage="No ha seleccionado vehiculo" value="#{reservacionBean.vehiculoView.vehPlaca}"/>                                                      
                                                </h:panelGrid>
                                            </div>

                                            <div class="form-group box box-danger direct-chat direct-chat-danger">                                               
                                                <p:dataScroller var="vehiculo" mode="inline" id="ScrollerVehiculos" value="#{reservacionBean.vehiculosListView}" chunkSize="5">
                                                    <f:facet name="header">
                                                        Explore hacia abajo para cargar mas vehiculos.
                                                    </f:facet>

                                                    <f:facet name="loader">
                                                        <p:commandButton type="button" value="Mas" icon="ui-icon-circle-triangle-s"/>
                                                    </f:facet>

                                                    <h:panelGrid columns="2" cellpadding="5" cellspacing="10" columnClasses="grid,grid">

                                                        <p:graphicImage width="256" height="256" value="#{vehiculo.vehFotoRuta}" alt="Vehiculo" class="img-thumbnail img-responsive"/>
                                                        <p:outputPanel>
                                                            <h:panelGrid columns="2" cellpadding="5" width="100%">
                                                                <h:outputText value="Marca:" />
                                                                <h:outputText value="#{vehiculo.smsReferencia.smsMarca.marcaNombre}" style="font-weight: bold"/>

                                                                <h:outputText value="Referencia:" />
                                                                <h:outputText value="#{vehiculo.smsReferencia.referenciaNombre}" style="font-weight: bold"/>

                                                                <h:outputText value="Placa:" />
                                                                <h:outputText value="#{vehiculo.vehPlaca}" style="font-weight: bold"/>

                                                                <h:outputText value="Color:" />
                                                                <h:outputText value="#{vehiculo.vehColor}" style="font-weight: bold"/>

                                                                <h:outputText value="Personas:" />
                                                                <h:outputText value="#{vehiculo.vehNumPersonas}" style="font-weight: bold"/>

                                                                <h:outputText value="Maletas grandes:" />
                                                                <h:outputText value="#{vehiculo.vehNumMalGrande}" style="font-weight: bold"/>

                                                                <h:outputText value="Maletas pequeños:" />
                                                                <h:outputText value="#{vehiculo.vehNumMalPequeña}" style="font-weight: bold"/>

                                                                <p:commandButton  class="btn-reservas btn-reservas-color" value="Seleccionar Vehiculo" disabled="#{reservacionBean.selecVeh}"  process="@this" update="@form" action="#{reservacionBean.SeleccionarVehiculo()}">
                                                                    <f:setPropertyActionListener value="#{vehiculo}" target="#{reservacionBean.vehiculoView}"/>
                                                                </p:commandButton>
                                                            </h:panelGrid>
                                                        </p:outputPanel>
                                                    </h:panelGrid>
                                                    <p:separator/>
                                                </p:dataScroller>                                                
                                            </div>
                                        </b:panel>
                                    </p:tab>

                                    <p:tab id="Conductor" title="Conductor">
                                        <b:panel title="Escoja y Seleccione Conductor" look="primary">
                                            <p:messages />                                       
                                            <p style="margin-top: 12px">Aqui podrá elegir el conductor que desea para su reservacion, pero si desea, puede realizar su reservacion sin elegir conductor.</p>
                                            <hr/>
                                            <div class="box box-danger direct-chat direct-chat-danger">
                                                <p:dataScroller var="empleado" id="ScrollerConductores" value="#{reservacionBean.empleadosListView}" chunkSize="5" >
                                                    <f:facet name="header">
                                                        Explore hacia abajo para cargar mas conductores.
                                                    </f:facet>

                                                    <f:facet name="loader">
                                                        <p:commandButton type="button" value="Mas" icon="ui-icon-circle-triangle-s"/>
                                                    </f:facet>

                                                    <h:panelGrid  columns="2" cellpadding="5" cellspacing="10" columnClasses="grid,grid">
                                                        <p:graphicImage width="160" height="180" value="#{empleado.smsUsuario.usuarioFotoRuta}" class="img-thumbnail img-responsive"/> 

                                                        <p:outputPanel>
                                                            <h:panelGrid width="100%" columns="2" cellpadding="5">

                                                                <h:outputText value="Nombre y apellidos:" />
                                                                <h:outputText value="#{empleado.smsUsuario.usuarioNombre}" style="width: 100%;font-weight: bold"/>

                                                                <h:outputText value="Identificación" />
                                                                <h:outputText value="#{empleado.smsUsuario.usuarioCc}" style="width: 100%;font-weight: bold"/>

                                                                <p:commandButton class="btn-reservas btn-reservas-color" value="Seleccionar Conductor" disabled="#{reservacionBean.selecCon}"  process="@this" update="ScrollerConductores" action="#{reservacionBean.SeleccionarConductor()}">
                                                                    <f:setPropertyActionListener value="#{empleado}" target="#{reservacionBean.empleadoView}"/>
                                                                </p:commandButton>
                                                            </h:panelGrid>
                                                        </p:outputPanel>
                                                    </h:panelGrid>
                                                    <p:separator/>
                                                </p:dataScroller>
                                            </div>
                                        </b:panel>
                                    </p:tab>


                                    <p:tab id="Confirmacion" title="Confirmación">
                                        <b:panel title="Confirmación" look="primary">
                                            <h4>Datos de reservacion:</h4>
                                            <h:panelGrid id="confirmacion" columns="4" columnClasses="grid,grid,grid,grid">

                                                <p:outputLabel value="Cliente: " style="font-weight: bold"/>
                                                <p:outputLabel value="#{reservacionBean.clienteView.usuarioNombre}"/>

                                                <p:outputLabel/>
                                                <p:outputLabel/>

                                                <p:outputLabel value="Ciudad: " style="font-weight: bold"/>
                                                <p:outputLabel value="#{reservacionBean.ciudadView.ciudadNombre}"/>

                                                <p:outputLabel value="Costo" style="font-weight: bold"/>
                                                <p:outputLabel value="#{reservacionBean.reservaView.reservacionCosto}"/>

                                                <p:outputLabel value="Lugar de recogida: " style="font-weight: bold"/>
                                                <p:outputLabel value="#{reservacionBean.reservaView.reservacionLugarLlegada}"/>

                                                <p:outputLabel value="Lugar de Entrega: " style="font-weight: bold"/>
                                                <p:outputLabel value="#{reservacionBean.reservaView.reservacionLugarDestino}"/>

                                                <p:outputLabel value="Fecha inicio: " style="font-weight: bold"/>
                                                <p:outputLabel value="#{reservacionBean.reservaView.reservacionFechaInicio}">
                                                    <f:convertDateTime pattern="yyyy-MM-dd"/>
                                                </p:outputLabel>

                                                <p:outputLabel value="Fecha llegada: " style="font-weight: bold"/>
                                                <p:outputLabel value="#{reservacionBean.reservaView.reservacionFechaLlegada}">
                                                    <f:convertDateTime pattern="yyyy-MM-dd"/>
                                                </p:outputLabel>

                                                <p:outputLabel value="Hora inicio: " style="font-weight: bold"/>
                                                <p:outputLabel value="#{reservacionBean.horaInicio}">
                                                </p:outputLabel>

                                                <p:outputLabel value="Hora llegada: " style="font-weight: bold"/>
                                                <p:outputLabel value="#{reservacionBean.horaEntrega}">
                                                </p:outputLabel>

                                            </h:panelGrid>
                                            <p:inputTextarea rows="4" style="width: 100%" value="#{reservacionBean.reservaView.reservacionNotas }" placeholder="Notas u observaciones"/>
                                            <p:separator/>
                                            <h4>Vehiculo</h4>
                                            <p:dataScroller var="vehiculo" mode="inline" value="#{reservacionBean.vehiculoView}">                                                
                                                <h:panelGrid columns="2" cellspacing="10" cellpadding="5" columnClasses="logo,detail">

                                                    <p:graphicImage width="180" height="180" value="#{vehiculo.vehFotoRuta}" class="img-thumbnail img-responsive"/>

                                                    <p:outputPanel>
                                                        <h:panelGrid columns="2" cellpadding="5" cellspacing="10">

                                                            <h:outputText value="Marca:" />
                                                            <h:outputText value="#{vehiculo.smsReferencia.smsMarca.marcaNombre}" style="font-weight: bold"/>

                                                            <h:outputText value="Referencia:" />
                                                            <h:outputText value="#{vehiculo.smsReferencia.referenciaNombre}" style="font-weight: bold"/>

                                                            <h:outputText value="Placa:" />
                                                            <h:outputText value="#{vehiculo.vehPlaca}" style="font-weight: bold"/>

                                                            <h:outputText value="Color:" />
                                                            <h:outputText value="#{vehiculo.vehColor}" style="font-weight: bold"/>

                                                            <h:outputText value="Personas:" />
                                                            <h:outputText value="#{vehiculo.vehNumPersonas}" style="font-weight: bold"/>

                                                            <h:outputText value="Maletas grandes:" />
                                                            <h:outputText value="#{vehiculo.vehNumMalGrande}" style="font-weight: bold"/>

                                                            <h:outputText value="Maletas pequeños:" />
                                                            <h:outputText value="#{vehiculo.vehNumMalPequeña}" style="font-weight: bold"/>
                                                        </h:panelGrid>
                                                    </p:outputPanel>                                                        
                                                </h:panelGrid>                                                
                                            </p:dataScroller>
                                            <p:separator/>
                                            <h4>Empleado</h4>
                                            <p:dataScroller var="empleado" value="#{reservacionBean.empleadoView}">
                                                <h:panelGrid columns="2" cellspacing="10" cellpadding="5" columnClasses="logo,detail">

                                                    <p:graphicImage width="180" height="180" value="#{empleado.smsUsuario.usuarioFotoRuta}" class="img-thumbnail img-responsive"/>

                                                    <p:outputPanel>
                                                        <h:panelGrid columns="2" cellpadding="5" cellspacing="10">

                                                            <h:outputText value="Nombre y apellidos:" />
                                                            <h:outputText value="#{empleado.smsUsuario.usuarioNombre}" style="font-weight: bold"/>

                                                            <h:outputText value="Identificacion" />
                                                            <h:outputText value="#{empleado.smsUsuario.usuarioCc}" style="font-weight: bold"/>

                                                        </h:panelGrid>
                                                    </p:outputPanel>

                                                </h:panelGrid>                                                
                                            </p:dataScroller>
                                            <p:separator/>
                                            <center><b:commandButton value="Confirmar reservación" onclick="PrimeFaces.monitorDownload(start, stop);" action="#{reservacionBean.registrarReservacion()}" style="width: 80%" update="@form"/></center>
                                        </b:panel>
                                        <script type="text/javascript">
                                            function start() {
                                                PF('statusDialog').show();
                                            }

                                            function stop() {
                                                PF('statusDialog').hide();
                                            }
                                        </script>
                                        <p:dialog modal="true" widgetVar="statusDialog" header="Registrando Reservacion" draggable="false" closable="false" resizable="false">
                                            <p:graphicImage width="100%" value="/resources/images/demo/ajaxloadingbar.gif" />
                                        </p:dialog>
                                    </p:tab>
                                </p:wizard>
                            </h:form>
                        </div>
                    </b:column>  
                </b:row>
            </b:container>
        </ui:define>
    </ui:composition>
</html>
